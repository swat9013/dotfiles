# 設計レビュー用語集

## レイヤー構成（クリーンアーキテクチャ例）

| レイヤー | 責務 | 依存方向 |
|----------|------|----------|
| Presentation | UI、APIエンドポイント | → Application |
| Application | ユースケース | → Domain |
| Domain | ビジネスルール | 依存なし（中心） |
| Infrastructure | 外部連携 | → Domain |

**原則**: 外側→内側のみ依存。Domain は何にも依存しない。

## 境界の種類

| 境界 | 越える際のルール |
|------|------------------|
| モジュール境界 | 名前のコナーセンス（CoN）で十分 |
| パッケージ境界 | インターフェース経由を推奨 |
| レイヤー境界 | 依存逆転、データ結合を徹底 |
| サービス境界 | API契約、冪等性が必須 |

## 結合度（弱い順）

| 種類 | 問題度 |
|------|--------|
| データ結合（プリミティブのみ渡す） | 最良 |
| スタンプ結合（複合データの一部使用） | 軽度 |
| 制御結合（フラグで振る舞い変更） | 中度 |
| 共通結合（グローバル状態共有） | 高度 |
| 内容結合（内部を直接参照） | 最悪 |

## コナーセンス

**静的**（弱い順）: 名前(CoN) → 型(CoT) → 意味(CoM) → 位置(CoP) → アルゴリズム(CoA)

**動的**（より強い）: 実行順序(CoE) → タイミング(CoTm) → 値(CoV) → 同一性(CoI)

**評価軸**: 強度（強いほど困難）、局所性（遠いほど問題）、程度（広いほど問題）

## 抽象レベル（SLAP）

| レベル | 特徴 | 例 |
|--------|------|-----|
| 高 | 「何をするか」 | validateOrder(), sendNotification() |
| 中 | ビジネスルール | if (order.total > limit) |
| 低 | 技術的詳細 | db.query(), JSON.parse() |

**原則**: 1関数内では同じ抽象度の処理のみ記述。混在していたら分離。

## モデリング

| リソース | イベント |
|---------|---------|
| 現在状態を表す、CRUDで管理 | 過去の事実、不変、追記のみ |
| User, Order, Product | OrderPlaced, PaymentReceived |

| エンティティ | バリューオブジェクト |
|-------------|-------------------|
| IDで識別、状態変更あり | 値で識別、不変 |
| User(id=1) | Money(100, JPY), Email("a@b.com") |

**ロジック配置の優先順**:
1. バリューオブジェクト
2. エンティティ
3. ドメインサービス（どちらにも属さない場合のみ）
