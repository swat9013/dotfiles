# Claude Code ガイドライン

## コーディング哲学

### 設計原則
- 複雑さは問題定義の欠陥を示す。解決策ではなく、問いを再定義する。
- 今必要なものだけを作る。「将来のため」の拡張性は追加しない。
- 一つのことを上手くやる小さな単位を作り、それらを組み合わせる。

### 実装指針
- 名前で意図を表現する。
- 迷ったら可読性を優先する。
- 症状ではなく根本原因を修正する。その場しのぎの回避策は禁止。
- 暗黙のフォールバックは禁止。エラーは明示的に処理する。
- boolean引数は禁止。パラメータで振る舞いを分岐させない。
- 安易なオプショナルは避ける。呼び出し側に意図を表現させる。
- 成果物ごとに表現を分ける:

  | 成果物 | 表現 | 内容 |
  |--------|------|------|
  | コード | How | 実装方法はコード自体が語る |
  | テスト | What | 仕様を表現する |
  | コミットログ | Why | 変更の動機と背景 |
  | コメント | Why not | 非自明な選択の理由のみ |

### 構造設計
- 最もシンプルな解決策を選ぶ（KISS）。
- 同じ責務のコードは集約する（DRY）。
- 関数内の文は同じ抽象レベルに保つ（SLAP）。
- 1クラス/モジュール、1責務（SRP）。

## インタラクションルール
- 不明点があれば積極的に質問する。
- 選択肢を提示するときは推奨案と理由を添える。
- 回答を生成する前に、不足しているコンテキストを確認する。
- 選択肢の提示や確認には `AskUserQuestion` ツールを使用する。
- ユーザーから行動を修正されたら、再発防止のルール化を提案する。配置先は影響範囲で判断: 全プロジェクト共通 → CLAUDE.md、パス固有 → rules/、個人パターン → memory。

## 作業ルール
- 自動テストがある場合、仕様変更はまずテストに反映する。テストは機能仕様の信頼できるソース。
- プロジェクトで案内されているスクリプトやツールがあれば、それを優先使用する。
- ツールが動作しない場合は、不具合を修正してから作業を進める。ツールをバイパスして直接ライブラリを実行することは禁止。
- 可能な限りタスクを並列実行する。
- サブエージェント委譲は基本sonnet、軽量タスク（単純な検索、ファイル存在確認、定型出力の収集等）のみhaiku。
- `rm` → `rmtrash` で誤削除防止（ディレクトリ削除時は `rmtrash -r`）。

## スキル活用
- 依頼内容がスキルの `description` トリガーに該当する場合、自前で手順を組み立てず既存スキルを優先呼び出しする。
- `user-invocable: false` の参照スキルも、該当コンテキストで積極的にロードする。
