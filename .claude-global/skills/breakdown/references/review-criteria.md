# タスク分解レビュー基準

implementation.md の品質を検証する7カテゴリ。

## 目次

1. [推定精度](#1-推定精度)
2. [タスク粒度](#2-タスク粒度)
3. [依存関係の完全性](#3-依存関係の完全性)
4. [plan.md との整合性](#4-planmd-との整合性)
5. [タスク種別の正確性](#5-タスク種別の正確性)
6. [成功基準の具体性](#6-成功基準の具体性)
7. [テスト配置の明確性](#7-テスト配置の明確性)
8. [高信号フィルタ](#高信号フィルタ)

---

## 1. 推定精度

**フラグ基準**:
- plan.md のフェーズ推定との乖離 ±50% 超で理由未記載
- 分析・調査・設計を含むタスクが 0.5h 以下

**改善**: 乖離理由を実装概要に追記。分析系は最低 1h。

---

## 2. タスク粒度

**フラグ基準**:
- 3h 超の単一タスク
- 3つ以上の独立した変更を含むタスク
- 切り戻しが他タスクに波及するタスク

**改善**: サブタスクに分割（ファイル単位 or 機能単位）。

---

## 3. 依存関係の完全性

**フラグ基準**:
- Pマーク付きタスク同士が同一ファイルを編集
- import/export 依存先が未完了でも並列可能とされている
- 型定義変更タスクとその利用タスクが独立扱い

**改善**: 一方のPマーク除去＋依存追加。型定義タスクを先行に。

---

## 4. plan.md との整合性

**フラグ基準**:
- plan.md の要件がどのタスクにも未対応
- フェーズ構成が大幅に異なり理由未記載
- plan.md の制約条件がタスクに未反映

**改善**: 対応タスク追加、または除外理由を実装概要に記載。

---

## 5. タスク種別の正確性

**フラグ基準**:
- 「新機能実装」だが既存コード修正のみ
- 「テスト追加」だが実装変更を含む
- 「リファクタリング」だが振る舞い変更あり

**改善**: 種別を実態に合わせて修正。

---

## 6. 成功基準の具体性

**フラグ基準**:
- 全基準が主観的表現のみ（「適切に」「正しく」「カバーされている」）
- 数値・コマンド・具体的出力のいずれも含まない

**改善例**:
- 「適切にエラーハンドリング」→「400/404/500を返しエラーメッセージに原因を含む」
- 「正しく動作する」→「入力Xに対して出力Yを返す」

---

## 7. テスト配置の明確性

**フラグ基準**:
- テスト追加タスクにファイルパス未記載
- テスト種別（単体/結合/E2E）が不明
- テスト対象の関数・クラス名が未特定

**改善**: パス・種別・対象を明示（例: `src/__tests__/UserService.test.ts` に単体テスト）。

---

## 高信号フィルタ

フラグを立てるのは**具体的・測定可能な問題のみ**。

**対象**: 上記フラグ基準に該当、数値で示せる乖離、構造的に検証可能な不整合

**対象外**: スタイルの好み、推測に基づく懸念、plan.md 自体の問題、最適化提案
