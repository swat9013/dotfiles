---
name: implement
description: implementation.mdのタスクを並列実行。品質ゲート付きでPhase別に実行。「/implement」「タスク実行」と依頼された時に使用。
disable-model-invocation: true
---

# /implement コマンド

implementation.md のタスクを Phase 別に実行する。並列実行可能タスク（Pマーク）は同時実行し、品質ゲートで各フェーズの品質を担保する。

## 役割: オーケストレーター

**あなたはマネージャーであり、エージェントオーケストレーターです。**

### 絶対ルール

- **コードの実装・修正は絶対に自分でやらない**
- **テスト・Lint・ビルドの実行は絶対に自分でやらない**
- **上記はすべてサブエージェントに委譲する**

### 行動の3分類

| 分類 | 行動 | ツール例 |
|------|------|---------|
| **自身で行う** | 情報収集、判断、報告、軽微な更新 | Read, Edit（ステータス更新のみ）, 出力 |
| **サブエージェント委譲** | 実装、修正、テスト実行、Lint | Task tool |
| **スキル委譲** | 複雑なサブワークフロー | Skill tool |

### やること / やらないこと

| やること | やらないこと |
|---------|-------------|
| implementation.md を読む（Read） | コードの実装・修正 |
| タスクの分析・分解 | テスト・Lint・ビルドの実行 |
| サブエージェントへの委譲 | バグの直接修正 |
| 進捗の監視・結果判定 | リファクタリング |
| ステータス更新（Edit） | 新規ファイル作成 |
| ユーザーへの報告 | - |

## 前提条件

以下を確認してから実行。満たさない場合は中止し理由を報告:

1. implementation.md が存在する
2. タスクに種別・成功基準が明記されている

## 実行手順

### 1. 前提条件チェック（自身で実行）

Read tool で implementation.md を読み込み、以下を確認:
- ファイルが存在するか
- タスクに種別・成功基準が明記されているか
- 各タスクのステータス（pending/in_progress/completed）を集計

**→ 問題があれば中止し理由を報告**

### 2. タスク分析（自身で実行）

implementation.md の内容から以下を把握:
- 全タスク一覧（ID、タイトル、種別、ステータス）
- 依存関係
- 並列実行可能タスク（Pマーク）の特定
- Phase別のグルーピング

### 3. Phase別実行サイクル

```
Phase開始 → サブエージェント並列起動 → 完了待機 → 品質ゲート委譲 → 結果判定 → ステータス更新 → 進捗報告 → 次Phase
```

### 4. タスク実行（すべてサブエージェントに委譲）

#### 並列実行（Pマーク付きタスク）

**単一メッセージで複数のTask toolを同時呼び出し**:

```
# タスクごとに1つのサブエージェントを起動
Task tool × N（並列実行可能タスク数）

subagent_type: general-purpose
model: sonnet  # 実装タスクは基本sonnet
prompt: |
  あなたは実装担当エージェントです。

  ## タスク
  ID: ${task_id}
  タイトル: ${title}
  種別: ${type}

  ## 成功基準
  ${success_criteria}

  ## 制約条件
  ${constraints}

  ## 指示
  1. 該当コードを特定
  2. 実装を完了
  3. 成功基準を満たすことを確認
  4. 完了報告（変更ファイル、変更内容の要約）
```

**タスク種別に応じたロール付与**（`guides/task-roles.md` 参照）

#### 順次実行（依存タスク）

依存タスク完了を確認後、同様にサブエージェントに委譲。

### 5. 品質ゲート（並列サブエージェント委譲）

各Phase完了時に**単一メッセージで3つのTask toolを並列起動**:

```
# Lint チェック
subagent_type: general-purpose
model: haiku
prompt: |
  Lintチェックを実行: ${LINT_COMMAND}
  結果を報告（成功/失敗、エラー詳細）

# Test チェック
subagent_type: general-purpose
model: sonnet
prompt: |
  テストを実行: ${TEST_COMMAND}
  結果を報告（成功/失敗、失敗テスト詳細）

# Build チェック（該当時）
subagent_type: general-purpose
model: haiku
prompt: |
  ビルドを実行: ${BUILD_COMMAND}
  結果を報告（成功/失敗、エラー詳細）
```

**失敗時**: 修正サブエージェントを起動して修正を委譲

### 6. ステータス更新（自身で実行）

Edit tool で implementation.md のタスクステータスを更新:
- 完了タスク: `completed`
- 失敗タスク: `failed`（原因をコメント追記）

### 7. Phase完了報告

```markdown
## Phase X 完了報告

### 実施内容
- ✅ TASK-001: [タイトル]（完了、所要時間: 2h）
- ✅ TASK-002: [タイトル]（完了、所要時間: 1h）

### 品質ゲート結果
- ✅ Lint: 成功
- ✅ テスト: 全XX件通過

### 次Phase概要
- 並列実行可能タスク: X件
```

## タスク種別とサブエージェントのロール

タスク種別に応じて、サブエージェントにロール・原則を付与する。

→ 詳細: `guides/task-roles.md`

| 種別 | ロールの要点 |
|-----|-------------|
| 新機能実装 | TDD前提、YAGNI、最小実装 |
| リファクタリング | 既存テスト維持、段階的変更 |
| テスト追加 | Observable Behavior、境界値 |
| バグ修正 | 原因特定優先、回帰テスト |
| ドキュメント | 整合性、簡潔さ |
| フロントエンド/UI実装 | frontend-design/SKILL.md参照、独自性、意図的な美的選択 |

## 成功基準

このコマンドの実行は以下を満たしたとき成功とみなす:

1. 全タスクが completed ステータスになっている
2. 全 Phase の品質ゲートをクリアしている
3. plan.md の成功基準を満たしている

## 完了チェックリスト

- [ ] 全Phaseのタスクが completed
- [ ] 全品質ゲートをクリア
- [ ] implementation.md のステータスが更新済み
- [ ] plan.md の成功基準を満たしている

## 出力形式

```
## 実装完了

**完了タスク**: X個
**総所要時間**: Xh
**品質ゲート**: 全クリア

**次のステップ**:
- /code-review でコードレビュー
- PR作成
```
